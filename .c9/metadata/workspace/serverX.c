{"filter":false,"title":"serverX.c","tooltip":"/serverX.c","undoManager":{"mark":8,"position":8,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":91,"column":0},"action":"insert","lines":["#include <stdio.h>","#include <sys/types.h>\t/* system type defintions */","#include <sys/socket.h>\t/* network system functions */","#include <netinet/in.h>\t/* protocol & struct definitions */","#include <stdlib.h>\t/* exit() warnings */","#include <string.h>\t/* memset warnings */","","void func(int);","#define BUF_SIZE\t1024","#define LISTEN_PORT\t60000","","int main(int argc, char *argv[]){","    int\tsock_listen,sock_recv;","    struct sockaddr_in\tmy_addr,recv_addr;","    int i,addr_size,bytes_received,pid;","    fd_set readfds;","    //struct timeval\ttimeout={0,0};","    int\tincoming_len;","    struct sockaddr\tremote_addr;","    //int\trecv_msg_size;","    //char buf[BUF_SIZE];","    int\tselect_ret;","","","            /* create socket for listening */","    sock_listen=socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);","    if (sock_listen < 0){","        printf(\"error...socket() failed\\n\");","        exit(0);","    }","        /* make local address structure */","    memset(&my_addr, 0, sizeof (my_addr));\t/* zero out structure */","    my_addr.sin_family = AF_INET;\t/* address family */","    my_addr.sin_addr.s_addr = htonl(INADDR_ANY);  /* current machine IP */","    my_addr.sin_port = htons((unsigned short)LISTEN_PORT);","        /* bind socket to the local address */","    i=bind(sock_listen, (struct sockaddr *) &my_addr, sizeof (my_addr));","    if (i < 0){","        printf(\"error...bind() failed\\n\");","        exit(0);","    }","        /* listen ... */","    listen(sock_listen, 5);","    addr_size=sizeof(recv_addr);","","        /* get new socket to receive data on */","\twhile(1){","\tsock_recv=accept(sock_listen, (struct sockaddr *) &recv_addr, &addr_size);","       // bytes_received=recv(sock_recv,buf,BUF_SIZE,0);","        //buf[bytes_received]=0;","\t","\tif (sock_recv < 0)","        printf(\"error...listen() failed\\n\");","        //exit(0);","\t","        pid=fork();","\tif (pid<0)","\t   printf(\"error...fork() failed\\n\");","\tif (pid == 0)  {","           close(sock_listen);","           func(sock_recv);","           exit(0);","    }","\telse close(sock_recv);","   }","   close(sock_listen);","   return 0;","}","","void func (int sock)","{","   int x;","   char buffer[1024];","   while(1){","     ","   bzero(buffer,1024);","   x = read(sock,buffer,1024);","   if (x < 0)","     printf(\"Client communication has been disconnect\");","   printf(\"Message received: %s\\n\",buffer);","   x = write(sock,\"I got your message\",18);","   if (x < 0) ","     printf(\"error...failed to write to socket\");","     ","  }","  ","}","","    ","","",""]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":0},"end":{"row":69,"column":1},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":1},"end":{"row":69,"column":2},"action":"insert","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":2},"end":{"row":85,"column":3},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":2},"end":{"row":85,"column":3},"action":"insert","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":3},"end":{"row":85,"column":4},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":2},"end":{"row":85,"column":3},"action":"remove","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":1},"end":{"row":69,"column":2},"action":"remove","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":69,"column":0},"end":{"row":69,"column":1},"action":"remove","lines":["/"]}]}]]},"ace":{"folds":[],"scrolltop":720,"scrollleft":0,"selection":{"start":{"row":89,"column":0},"end":{"row":89,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":50,"state":"start","mode":"ace/mode/c_cpp"}},"timestamp":1428907843597,"hash":"67530e515fe91762bd5203b9883b39ccc7b2b9c0"}